<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>change 이벤트</title>
    <style type="text/css">
      @import url("https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap");

      body {
        font-family: "Nanum Gothic", sans-serif;
        font-weight: 400;
        font-style: normal;
      }

      * {
        text-align: center;
      }

      table,
      th,
      td {
        border: 3px solid grey;
        border-collapse: collapse;
      }

      table,
      tr,
      td {
        margin: 0 auto;
        width: 120px;
      }

      th,
      .bg {
        background-color: #036;
        color: white;
        font-weight: bold;
      }
    </style>
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <script type="text/javascript">
      $(document).ready(function () {
        $("#basicOption, :checkbox").change(function () {
          // 선택된 옵션의 가격을 가져와서 숫자로 변환
          const basicOptionPrice = Number($("#basicOption").val());
          // 체크박스의 가격을 합산
          let checkboxTotal = 0;
          $(":checkbox:checked").each(function () {
            checkboxTotal += Number($(this).val());
          });
          // 총 가격 계산
          const totalPrice = 4500000 + basicOptionPrice + checkboxTotal;
          // 화면에 표시
          $("#amount").text(`${totalPrice.toLocaleString("ko-KR")} 원`);
        });

        //        // jQuery Proxy를 사용하여 가격 계산
        //        // React나 Vue.js의 State와 유사한 기능
        //        const handler = {
        //          // Proxy를 사용하여 객체의 속성 변경을 감지
        //          /** @param {Object} target - 원본 객체 */
        //          /** @param {string} property - 변경된 속성 이름 */
        //          /** @param {number} value - 변경된 값 */
        //          /** @returns {boolean} - 성공 여부 */
        //          set: (target, property, value) => {
        //            // 원본 객체의 속성을 변경
        //            target[property] = value;
        //            // 가격이 변경되면 화면에 표시
        //            if (property === "baseOption" || property === "additionalOptions") {
        //              const total = target.intialPrice + target.baseOption + target.additionalOptions;
        //              // Intl.NumberFormat을 사용하여 숫자를 한국어 형식으로 포맷
        //              $("#amount").text(`${Intl.NumberFormat("ko-KR").format(total)} 원`);
        //            }
        //            // 변경이 성공적으로 이루어졌음을 반환
        //            return true;
        //          },
        //          // Proxy를 사용하여 객체의 속성 접근을 감지
        //          /** @param {Object} target - 원본 객체 */
        //          /** @param {string} property - 접근한 속성 이름 */
        //          /** @returns {any} - 속성 값 */
        //          get: (target, property) => {
        //            // 원본 객체의 속성 값을 반환
        //            return target[property];
        //          },
        //        };
        //
        //        // 초기 설정 객체
        //        const initalSetting = {
        //          message: "init",
        //          intialPrice: 4500000,
        //          baseOption: 0,
        //          additionalOptions: 0,
        //        };
        //
        //        // Proxy를 사용하여 가격 객체 생성
        //        // 초기 메시지와 기본 가격을 설정
        //        const price = new Proxy(initalSetting, handler);
        //
        //        // 기본 옵션 jQuery 객체를 선택
        //        const $options = $("#basicOption");
        //
        //        // 기본 옵션 변경 이벤트 핸들러
        //        $options.change(function () {
        //          // 선택된 옵션의 가격을 가져와서 숫자로 변환
        //          const basicOptionPrice = Number($options.val());
        //          price.baseOption = basicOptionPrice;
        //        });
        //
        //        // 체크박스 변경 이벤트 핸들러
        //        $(":checkbox").change(function () {
        //          const checkboxPrice = Number($(this).val());
        //          // 가격 객체의 추가 옵션 가격을 업데이트
        //          if ($(this).is(":checked")) price.additionalOptions += checkboxPrice;
        //          else price.additionalOptions -= checkboxPrice;
        //        });
      }); // end of document ready
    </script>
  </head>
  <body>
    <h1>카메라 주문서</h1>
    <table>
      <tr>
        <td colspan="3"><img src="image/camera.jpg" /></td>
      </tr>
      <tr>
        <td class="bg">기본 가격</td>
        <td colspan="2">4,500,000 원</td>
      </tr>
      <tr>
        <td class="bg">기본 옵션</td>
        <td colspan="2">
          <select id="basicOption">
            <option value="0">선택하세요</option>
            <option value="100000">삼각대 100,000원</option>
            <option value="50000">차량용 충전기 50,000원</option>
          </select>
        </td>
      </tr>
      <tr>
        <th>선택 옵션</th>
        <th>가격</th>
        <th>선택</th>
      </tr>
      <tr>
        <td>렌즈 필터</td>
        <td>30,000 원</td>
        <td><input type="checkbox" id="lenzFilter" value="30000" /></td>
      </tr>
      <tr>
        <td>DSLR 가방</td>
        <td>40,000 원</td>
        <td><input type="checkbox" id="dslrBag" value="40000" /></td>
      </tr>
      <tr>
        <td>청소도구</td>
        <td>7,000 원</td>
        <td><input type="checkbox" id="cleaningTools" value="7000" /></td>
      </tr>
      <tr>
        <td class="bg">주문액</td>
        <td id="amount" colspan="2">4,500,000 원</td>
      </tr>
    </table>
  </body>
</html>
